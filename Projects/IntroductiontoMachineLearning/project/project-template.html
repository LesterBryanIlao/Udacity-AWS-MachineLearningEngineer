<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>fdffbdcd60594187b6be22384efcb340</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="predict-bike-sharing-demand-with-autogluon-template" class="cell markdown">
<h1>Predict Bike Sharing Demand with AutoGluon Template</h1>
</section>
<section id="project-predict-bike-sharing-demand-with-autogluon" class="cell markdown">
<h2>Project: Predict Bike Sharing Demand with AutoGluon</h2>
<p>This notebook is a template with each step that you need to complete for the project.</p>
<p>Please fill in your code where there are explicit <code>?</code> markers in the notebook. You are welcome to add more cells and code as you see fit.</p>
<p>Once you have completed all the code implementations, please export your notebook as a HTML file so the reviews can view your code. Make sure you have all outputs correctly outputted.</p>
<p><code>File-&gt; Export Notebook As... -&gt; Export Notebook as HTML</code></p>
<p>There is a writeup to complete as well after all code implememtation is done. Please answer all questions and attach the necessary tables and charts. You can complete the writeup in either markdown or PDF.</p>
<p>Completing the code template and writeup template will cover all of the rubric points for this project.</p>
<p>The rubric contains "Stand Out Suggestions" for enhancing the project beyond the minimum requirements. The stand out suggestions are optional. If you decide to pursue the "stand out suggestions", you can include the code in this notebook and also discuss the results in the writeup file.</p>
</section>
<section id="step-1-create-an-account-with-kaggle" class="cell markdown">
<h2>Step 1: Create an account with Kaggle</h2>
</section>
<section id="create-kaggle-account-and-download-api-key" class="cell markdown">
<h3>Create Kaggle Account and download API key</h3>
<p>Below is example of steps to get the API username and key. Each student will have their own username and key.</p>
</section>
<div class="cell markdown">
<ol>
<li>Open account settings. <img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/kaggle1.png" alt="kaggle1.png" /> <img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/kaggle2.png" alt="kaggle2.png" /></li>
<li>Scroll down to API and click Create New API Token. <img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/kaggle3.png" alt="kaggle3.png" /> <img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/kaggle4.png" alt="kaggle4.png" /></li>
<li>Open up <code>kaggle.json</code> and use the username and key. <img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/kaggle5.png" alt="kaggle5.png" /></li>
</ol>
</div>
<section id="step-2-download-the-kaggle-dataset-using-the-kaggle-python-library" class="cell markdown">
<h2>Step 2: Download the Kaggle dataset using the kaggle python library</h2>
</section>
<section id="open-up-sagemaker-studio-and-use-starter-template" class="cell markdown">
<h3>Open up Sagemaker Studio and use starter template</h3>
</section>
<div class="cell markdown">
<ol>
<li>Notebook should be using a <code>ml.t3.medium</code> instance (2 vCPU + 4 GiB)</li>
<li>Notebook should be using kernal: <code>Python 3 (MXNet 1.8 Python 3.7 CPU Optimized)</code></li>
</ol>
</div>
<section id="install-packages" class="cell markdown">
<h3>Install packages</h3>
</section>
<div class="cell code" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade sagemaker</span></code></pre></div>
</div>
<div class="cell code" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U pip</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U setuptools wheel</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U <span class="st">&quot;mxnet&lt;2.0.0&quot;</span> bokeh<span class="op">==</span><span class="fl">2.0.1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install autogluon <span class="op">--</span>no<span class="op">-</span>cache<span class="op">-</span><span class="bu">dir</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Without --no-cache-dir, smaller aws instances may have trouble installing</span></span></code></pre></div>
</div>
<section id="setup-kaggle-api-key" class="cell markdown">
<h3>Setup Kaggle API Key</h3>
</section>
<div class="cell code" data-trusted="true">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the .kaggle directory and an empty kaggle.json file</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>mkdir <span class="op">-</span>p <span class="op">/</span>root<span class="op">/</span>.kaggle</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>touch <span class="op">/</span>root<span class="op">/</span>.kaggle<span class="op">/</span>kaggle.json</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>chmod <span class="dv">600</span> <span class="op">/</span>root<span class="op">/</span>.kaggle<span class="op">/</span>kaggle.json</span></code></pre></div>
</div>
<div class="cell code" data-trusted="true">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill in your user name and key from creating the kaggle account and API token file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>kaggle_username <span class="op">=</span> <span class="st">&quot;lesterbryanilao&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>kaggle_key <span class="op">=</span> <span class="st">&quot;5a8a8028cafe24b4f0424653bc4f4dd0&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save API token the kaggle.json file</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;/root/.kaggle/kaggle.json&quot;</span>, <span class="st">&quot;w&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    f.write(json.dumps({<span class="st">&quot;username&quot;</span>: kaggle_username, <span class="st">&quot;key&quot;</span>: kaggle_key}))</span></code></pre></div>
</div>
<section id="download-and-explore-dataset" class="cell markdown">
<h3>Download and explore dataset</h3>
</section>
<div class="cell code" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install kaggle</span></code></pre></div>
</div>
<section id="go-to-the-bike-sharing-demand-competition-and-agree-to-the-terms" class="cell markdown">
<h3>Go to the bike sharing demand competition and agree to the terms</h3>
<p><img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/kaggle6.png" alt="kaggle6.png" /></p>
</section>
<div class="cell code" data-trusted="true">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the dataset, it will be in a .zip file so you&#39;ll need to unzip it as well.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions download <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># If you already downloaded it you can use the -o command to overwrite the file</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip <span class="op">-</span>o bike<span class="op">-</span>sharing<span class="op">-</span>demand.<span class="bu">zip</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="1" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:21.038308Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:21.039050Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:21.865848Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:21.039157Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:21.864839Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:24.810923Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:24.811367Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:24.869205Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:24.811408Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:24.868061Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the train dataset in pandas by reading the csv</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the parsing of the datetime column so you can use some of the `dt` features in pandas later</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">&quot;train.csv&quot;</span>, parse_dates<span class="op">=</span>[<span class="st">&quot;datetime&quot;</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="3" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:27.387764Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:27.388512Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:27.438900Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:27.388556Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:27.437662Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple output of the train dataset to view some of the min/max/varition of the dataset features.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>train.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.00000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.506614</td>
      <td>0.028569</td>
      <td>0.680875</td>
      <td>1.418427</td>
      <td>20.23086</td>
      <td>23.655084</td>
      <td>61.886460</td>
      <td>12.799395</td>
      <td>36.021955</td>
      <td>155.552177</td>
      <td>191.574132</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.116174</td>
      <td>0.166599</td>
      <td>0.466159</td>
      <td>0.633839</td>
      <td>7.79159</td>
      <td>8.474601</td>
      <td>19.245033</td>
      <td>8.164537</td>
      <td>49.960477</td>
      <td>151.039033</td>
      <td>181.144454</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.82000</td>
      <td>0.760000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>13.94000</td>
      <td>16.665000</td>
      <td>47.000000</td>
      <td>7.001500</td>
      <td>4.000000</td>
      <td>36.000000</td>
      <td>42.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>20.50000</td>
      <td>24.240000</td>
      <td>62.000000</td>
      <td>12.998000</td>
      <td>17.000000</td>
      <td>118.000000</td>
      <td>145.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>26.24000</td>
      <td>31.060000</td>
      <td>77.000000</td>
      <td>16.997900</td>
      <td>49.000000</td>
      <td>222.000000</td>
      <td>284.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>41.00000</td>
      <td>45.455000</td>
      <td>100.000000</td>
      <td>56.996900</td>
      <td>367.000000</td>
      <td>886.000000</td>
      <td>977.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="4" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:29.921438Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:29.922158Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:29.958778Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:29.922203Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:29.957350Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the test pandas dataframe in pandas by reading the csv, remember to parse the datetime!</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">&quot;test.csv&quot;</span>, parse_dates<span class="op">=</span>[<span class="st">&quot;datetime&quot;</span>])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>11.365</td>
      <td>56</td>
      <td>26.0027</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="5" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:31.809012Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:31.810726Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:31.835396Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:31.810776Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:31.834329Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing as train and test dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> pd.read_csv(<span class="st">&quot;sampleSubmission.csv&quot;</span>,  parse_dates<span class="op">=</span>[<span class="st">&quot;datetime&quot;</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>submission.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="step-3-train-a-model-using-autogluons-tabular-prediction" class="cell markdown">
<h2>Step 3: Train a model using AutoGluonâ€™s Tabular Prediction</h2>
</section>
<div class="cell markdown">
<p>Requirements:</p>
<ul>
<li>We are prediting <code>count</code>, so it is the label we are setting.</li>
<li>Ignore <code>casual</code> and <code>registered</code> columns as they are also not present in the test dataset.</li>
<li>Use the <code>root_mean_squared_error</code> as the metric to use for evaluation.</li>
<li>Set a time limit of 10 minutes (600 seconds).</li>
<li>Use the preset <code>best_quality</code> to focus on creating the best model.</li>
</ul>
</div>
<div class="cell code" data-execution_count="7" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:39.228225Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:39.228637Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:39.236245Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:39.228680Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:39.234984Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.loc[:, <span class="op">~</span>train.columns.isin([<span class="st">&#39;casual&#39;</span>, <span class="st">&#39;registered&#39;</span>])]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="8" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:43.233875Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:43.234550Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:44:43.280602Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:43.234624Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:44:43.279428Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>train.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.00000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.506614</td>
      <td>0.028569</td>
      <td>0.680875</td>
      <td>1.418427</td>
      <td>20.23086</td>
      <td>23.655084</td>
      <td>61.886460</td>
      <td>12.799395</td>
      <td>191.574132</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.116174</td>
      <td>0.166599</td>
      <td>0.466159</td>
      <td>0.633839</td>
      <td>7.79159</td>
      <td>8.474601</td>
      <td>19.245033</td>
      <td>8.164537</td>
      <td>181.144454</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.82000</td>
      <td>0.760000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>13.94000</td>
      <td>16.665000</td>
      <td>47.000000</td>
      <td>7.001500</td>
      <td>42.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>20.50000</td>
      <td>24.240000</td>
      <td>62.000000</td>
      <td>12.998000</td>
      <td>145.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>26.24000</td>
      <td>31.060000</td>
      <td>77.000000</td>
      <td>16.997900</td>
      <td>284.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>41.00000</td>
      <td>45.455000</td>
      <td>100.000000</td>
      <td>56.996900</td>
      <td>977.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="9" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:44:47.298042Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:44:47.298448Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:54:59.606551Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:44:47.298487Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:54:59.604919Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&quot;count&quot;</span>, problem_type<span class="op">=</span><span class="st">&quot;regression&quot;</span>, eval_metric<span class="op">=</span><span class="st">&quot;root_mean_squared_error&quot;</span>).fit(train_data<span class="op">=</span>train,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                                                                       time_limit<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                                                                       presets<span class="op">=</span><span class="st">&quot;best_quality&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230101_034447/&quot;
Presets specified: [&#39;best_quality&#39;]
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230101_034447/&quot;
AutoGluon Version:  0.6.1
Python Version:     3.7.12
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Sat Dec 10 10:12:26 UTC 2022
Train Data Rows:    10886
Train Data Columns: 9
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    32205.93 MB
	Train Data (Original)  Memory Usage: 0.78 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 2 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting DatetimeFeatureGenerator...
/opt/conda/lib/python3.7/site-packages/autogluon/features/generators/datetime.py:59: FutureWarning: casting datetime64[ns, UTC] values to int64 with .astype(...) is deprecated and will raise in a future version. Use .view(...) instead.
  good_rows = series[~series.isin(bad_rows)].astype(np.int64)
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;datetime&#39;, []) : 1 | [&#39;datetime&#39;]
		(&#39;float&#39;, [])    : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])      : 5 | [&#39;season&#39;, &#39;holiday&#39;, &#39;workingday&#39;, &#39;weather&#39;, &#39;humidity&#39;]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])                  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;humidity&#39;]
		(&#39;int&#39;, [&#39;bool&#39;])            : 2 | [&#39;holiday&#39;, &#39;workingday&#39;]
		(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
	0.4s = Fit runtime
	9 features in original data used to generate 13 features in processed data.
	Train Data (Processed) Memory Usage: 0.98 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.46s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 11 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 399.59s of the 599.54s of remaining time.
	-101.5737	 = Validation score   (-root_mean_squared_error)
	0.41s	 = Training   runtime
	0.04s	 = Validation runtime
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 397.15s of the 597.1s of remaining time.
	-84.14	 = Validation score   (-root_mean_squared_error)
	0.02s	 = Training   runtime
	0.04s	 = Validation runtime
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 397.06s of the 597.01s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.4609	 = Validation score   (-root_mean_squared_error)
	44.74s	 = Training   runtime
	7.01s	 = Validation runtime
Fitting model: LightGBM_BAG_L1 ... Training model for up to 339.62s of the 539.57s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.0542	 = Validation score   (-root_mean_squared_error)
	17.22s	 = Training   runtime
	1.53s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L1 ... Training model for up to 316.93s of the 516.87s of remaining time.
	-116.5443	 = Validation score   (-root_mean_squared_error)
	6.09s	 = Training   runtime
	0.63s	 = Validation runtime
Fitting model: CatBoost_BAG_L1 ... Training model for up to 309.59s of the 509.53s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-130.4612	 = Validation score   (-root_mean_squared_error)
	164.5s	 = Training   runtime
	0.11s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L1 ... Training model for up to 140.1s of the 340.04s of remaining time.
	-124.5881	 = Validation score   (-root_mean_squared_error)
	2.94s	 = Training   runtime
	0.6s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L1 ... Training model for up to 135.94s of the 335.89s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-136.0006	 = Validation score   (-root_mean_squared_error)
	51.5s	 = Training   runtime
	0.52s	 = Validation runtime
Fitting model: XGBoost_BAG_L1 ... Training model for up to 79.23s of the 279.17s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.6247	 = Validation score   (-root_mean_squared_error)
	27.36s	 = Training   runtime
	0.62s	 = Validation runtime
Fitting model: NeuralNetTorch_BAG_L1 ... Training model for up to 46.42s of the 246.36s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Time limit exceeded... Skipping NeuralNetTorch_BAG_L1.
Fitting model: LightGBMLarge_BAG_L1 ... Training model for up to 40.03s of the 239.98s of remaining time.
2023-01-01 03:50:47,385	ERROR worker.py:400 -- Unhandled error (suppress with &#39;RAY_IGNORE_UNHANDLED_ERRORS=1&#39;): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
2023-01-01 03:50:47,441	ERROR worker.py:400 -- Unhandled error (suppress with &#39;RAY_IGNORE_UNHANDLED_ERRORS=1&#39;): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
2023-01-01 03:50:47,450	ERROR worker.py:400 -- Unhandled error (suppress with &#39;RAY_IGNORE_UNHANDLED_ERRORS=1&#39;): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
	-130.1323	 = Validation score   (-root_mean_squared_error)
	20.75s	 = Training   runtime
	0.86s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 212.83s of remaining time.
	-84.14	 = Validation score   (-root_mean_squared_error)
	0.62s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 9 L2 models ...
Fitting model: LightGBMXT_BAG_L2 ... Training model for up to 212.2s of the 212.18s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-60.0779	 = Validation score   (-root_mean_squared_error)
	35.06s	 = Training   runtime
	3.24s	 = Validation runtime
Fitting model: LightGBM_BAG_L2 ... Training model for up to 170.79s of the 170.77s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-54.9577	 = Validation score   (-root_mean_squared_error)
	15.97s	 = Training   runtime
	0.45s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L2 ... Training model for up to 149.47s of the 149.46s of remaining time.
	-53.1467	 = Validation score   (-root_mean_squared_error)
	17.12s	 = Training   runtime
	0.71s	 = Validation runtime
Fitting model: CatBoost_BAG_L2 ... Training model for up to 130.95s of the 130.93s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-55.5759	 = Validation score   (-root_mean_squared_error)
	50.08s	 = Training   runtime
	0.07s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L2 ... Training model for up to 75.82s of the 75.8s of remaining time.
	-54.133	 = Validation score   (-root_mean_squared_error)
	5.16s	 = Training   runtime
	0.72s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L2 ... Training model for up to 69.25s of the 69.24s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-52.0214	 = Validation score   (-root_mean_squared_error)
	53.21s	 = Training   runtime
	0.57s	 = Validation runtime
Fitting model: XGBoost_BAG_L2 ... Training model for up to 10.94s of the 10.93s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-54.8088	 = Validation score   (-root_mean_squared_error)
	16.32s	 = Training   runtime
	0.31s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the -11.56s of remaining time.
	-50.7884	 = Validation score   (-root_mean_squared_error)
	0.66s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 612.27s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230101_034447/&quot;)
</code></pre>
</div>
</div>
<section id="review-autogluons-training-run-with-ranking-of-models-that-did-the-best" class="cell markdown">
<h3>Review AutoGluon's training run with ranking of models that did the best.</h3>
</section>
<div class="cell code" data-execution_count="10" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:55:18.398898Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:55:18.400077Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:55:18.637095Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:55:18.400125Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:55:18.635741Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>predictor.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -50.788422      13.949337  411.697326                0.001314           0.664790            3       True         19
1   NeuralNetFastAI_BAG_L2  -52.021372      12.526864  388.744984                0.567122          53.205698            2       True         17
2   RandomForestMSE_BAG_L2  -53.146724      12.665522  352.662355                0.705780          17.123069            2       True         14
3     ExtraTreesMSE_BAG_L2  -54.132970      12.675121  340.703768                0.715379           5.164482            2       True         16
4           XGBoost_BAG_L2  -54.808817      12.267464  351.859463                0.307722          16.320178            2       True         18
5          LightGBM_BAG_L2  -54.957749      12.409572  351.505109                0.449830          15.965823            2       True         13
6          CatBoost_BAG_L2  -55.575874      12.030076  385.620627                0.070334          50.081342            2       True         15
7        LightGBMXT_BAG_L2  -60.077859      15.203234  370.599327                3.243492          35.060041            2       True         12
8    KNeighborsDist_BAG_L1  -84.139994       0.040388    0.023303                0.040388           0.023303            1       True          2
9      WeightedEnsemble_L2  -84.139994       0.041315    0.639719                0.000927           0.616416            2       True         11
10   KNeighborsUnif_BAG_L1 -101.573722       0.040659    0.413787                0.040659           0.413787            1       True          1
11  RandomForestMSE_BAG_L1 -116.544294       0.631336    6.091171                0.631336           6.091171            1       True          5
12    ExtraTreesMSE_BAG_L1 -124.588053       0.595327    2.939291                0.595327           2.939291            1       True          7
13    LightGBMLarge_BAG_L1 -130.132290       0.858475   20.748918                0.858475          20.748918            1       True         10
14         CatBoost_BAG_L1 -130.461205       0.109018  164.499741                0.109018         164.499741            1       True          6
15         LightGBM_BAG_L1 -131.054162       1.526517   17.218405                1.526517          17.218405            1       True          4
16       LightGBMXT_BAG_L1 -131.460909       7.014914   44.744902                7.014914          44.744902            1       True          3
17          XGBoost_BAG_L1 -131.624665       0.622713   27.364055                0.622713          27.364055            1       True          9
18  NeuralNetFastAI_BAG_L1 -136.000551       0.520396   51.495713                0.520396          51.495713            1       True          8
Number of models trained: 19
Types of models trained:
{&#39;StackerEnsembleModel_RF&#39;, &#39;StackerEnsembleModel_XGBoost&#39;, &#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_LGB&#39;, &#39;StackerEnsembleModel_NNFastAiTabular&#39;, &#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_KNN&#39;, &#39;StackerEnsembleModel_CatBoost&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])                  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;humidity&#39;]
(&#39;int&#39;, [&#39;bool&#39;])            : 2 | [&#39;holiday&#39;, &#39;workingday&#39;]
(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="10">
<pre><code>{&#39;model_types&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;XGBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_XGBoost&#39;,
  &#39;LightGBMLarge_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L2&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;XGBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_XGBoost&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: -101.57372218106647,
  &#39;KNeighborsDist_BAG_L1&#39;: -84.13999364278118,
  &#39;LightGBMXT_BAG_L1&#39;: -131.46090891834504,
  &#39;LightGBM_BAG_L1&#39;: -131.054161598899,
  &#39;RandomForestMSE_BAG_L1&#39;: -116.54429428704391,
  &#39;CatBoost_BAG_L1&#39;: -130.46120460893414,
  &#39;ExtraTreesMSE_BAG_L1&#39;: -124.58805258915959,
  &#39;NeuralNetFastAI_BAG_L1&#39;: -136.00055126681914,
  &#39;XGBoost_BAG_L1&#39;: -131.62466543942023,
  &#39;LightGBMLarge_BAG_L1&#39;: -130.13228993716103,
  &#39;WeightedEnsemble_L2&#39;: -84.13999364278118,
  &#39;LightGBMXT_BAG_L2&#39;: -60.077859211902066,
  &#39;LightGBM_BAG_L2&#39;: -54.95774869322918,
  &#39;RandomForestMSE_BAG_L2&#39;: -53.14672382953503,
  &#39;CatBoost_BAG_L2&#39;: -55.57587368891331,
  &#39;ExtraTreesMSE_BAG_L2&#39;: -54.13296950115245,
  &#39;NeuralNetFastAI_BAG_L2&#39;: -52.02137195292307,
  &#39;XGBoost_BAG_L2&#39;: -54.80881674514753,
  &#39;WeightedEnsemble_L3&#39;: -50.7884221540271},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/KNeighborsUnif_BAG_L1/&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/KNeighborsDist_BAG_L1/&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/LightGBMXT_BAG_L1/&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/LightGBM_BAG_L1/&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/RandomForestMSE_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/CatBoost_BAG_L1/&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/ExtraTreesMSE_BAG_L1/&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/NeuralNetFastAI_BAG_L1/&#39;,
  &#39;XGBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/XGBoost_BAG_L1/&#39;,
  &#39;LightGBMLarge_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_034447/models/LightGBMLarge_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/LightGBMXT_BAG_L2/&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/LightGBM_BAG_L2/&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/RandomForestMSE_BAG_L2/&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/CatBoost_BAG_L2/&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/ExtraTreesMSE_BAG_L2/&#39;,
  &#39;NeuralNetFastAI_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/NeuralNetFastAI_BAG_L2/&#39;,
  &#39;XGBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_034447/models/XGBoost_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230101_034447/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.4137868881225586,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.023302555084228516,
  &#39;LightGBMXT_BAG_L1&#39;: 44.74490213394165,
  &#39;LightGBM_BAG_L1&#39;: 17.218404531478882,
  &#39;RandomForestMSE_BAG_L1&#39;: 6.091171026229858,
  &#39;CatBoost_BAG_L1&#39;: 164.4997410774231,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 2.939290761947632,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 51.49571347236633,
  &#39;XGBoost_BAG_L1&#39;: 27.364055395126343,
  &#39;LightGBMLarge_BAG_L1&#39;: 20.748918056488037,
  &#39;WeightedEnsemble_L2&#39;: 0.6164162158966064,
  &#39;LightGBMXT_BAG_L2&#39;: 35.060041427612305,
  &#39;LightGBM_BAG_L2&#39;: 15.965822696685791,
  &#39;RandomForestMSE_BAG_L2&#39;: 17.123069047927856,
  &#39;CatBoost_BAG_L2&#39;: 50.08134150505066,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 5.164482116699219,
  &#39;NeuralNetFastAI_BAG_L2&#39;: 53.20569849014282,
  &#39;XGBoost_BAG_L2&#39;: 16.32017755508423,
  &#39;WeightedEnsemble_L3&#39;: 0.6647903919219971},
 &#39;model_pred_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.04065871238708496,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.040387630462646484,
  &#39;LightGBMXT_BAG_L1&#39;: 7.01491379737854,
  &#39;LightGBM_BAG_L1&#39;: 1.5265169143676758,
  &#39;RandomForestMSE_BAG_L1&#39;: 0.631335973739624,
  &#39;CatBoost_BAG_L1&#39;: 0.10901761054992676,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 0.5953269004821777,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 0.5203962326049805,
  &#39;XGBoost_BAG_L1&#39;: 0.6227130889892578,
  &#39;LightGBMLarge_BAG_L1&#39;: 0.8584749698638916,
  &#39;WeightedEnsemble_L2&#39;: 0.0009274482727050781,
  &#39;LightGBMXT_BAG_L2&#39;: 3.2434918880462646,
  &#39;LightGBM_BAG_L2&#39;: 0.4498300552368164,
  &#39;RandomForestMSE_BAG_L2&#39;: 0.7057797908782959,
  &#39;CatBoost_BAG_L2&#39;: 0.07033443450927734,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 0.715378999710083,
  &#39;NeuralNetFastAI_BAG_L2&#39;: 0.567122220993042,
  &#39;XGBoost_BAG_L2&#39;: 0.3077220916748047,
  &#39;WeightedEnsemble_L3&#39;: 0.001314401626586914},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;KNeighborsDist_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;LightGBMXT_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;XGBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMLarge_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMXT_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;XGBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model   score_val  pred_time_val    fit_time  \
 0      WeightedEnsemble_L3  -50.788422      13.949337  411.697326   
 1   NeuralNetFastAI_BAG_L2  -52.021372      12.526864  388.744984   
 2   RandomForestMSE_BAG_L2  -53.146724      12.665522  352.662355   
 3     ExtraTreesMSE_BAG_L2  -54.132970      12.675121  340.703768   
 4           XGBoost_BAG_L2  -54.808817      12.267464  351.859463   
 5          LightGBM_BAG_L2  -54.957749      12.409572  351.505109   
 6          CatBoost_BAG_L2  -55.575874      12.030076  385.620627   
 7        LightGBMXT_BAG_L2  -60.077859      15.203234  370.599327   
 8    KNeighborsDist_BAG_L1  -84.139994       0.040388    0.023303   
 9      WeightedEnsemble_L2  -84.139994       0.041315    0.639719   
 10   KNeighborsUnif_BAG_L1 -101.573722       0.040659    0.413787   
 11  RandomForestMSE_BAG_L1 -116.544294       0.631336    6.091171   
 12    ExtraTreesMSE_BAG_L1 -124.588053       0.595327    2.939291   
 13    LightGBMLarge_BAG_L1 -130.132290       0.858475   20.748918   
 14         CatBoost_BAG_L1 -130.461205       0.109018  164.499741   
 15         LightGBM_BAG_L1 -131.054162       1.526517   17.218405   
 16       LightGBMXT_BAG_L1 -131.460909       7.014914   44.744902   
 17          XGBoost_BAG_L1 -131.624665       0.622713   27.364055   
 18  NeuralNetFastAI_BAG_L1 -136.000551       0.520396   51.495713   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.001314           0.664790            3       True   
 1                 0.567122          53.205698            2       True   
 2                 0.705780          17.123069            2       True   
 3                 0.715379           5.164482            2       True   
 4                 0.307722          16.320178            2       True   
 5                 0.449830          15.965823            2       True   
 6                 0.070334          50.081342            2       True   
 7                 3.243492          35.060041            2       True   
 8                 0.040388           0.023303            1       True   
 9                 0.000927           0.616416            2       True   
 10                0.040659           0.413787            1       True   
 11                0.631336           6.091171            1       True   
 12                0.595327           2.939291            1       True   
 13                0.858475          20.748918            1       True   
 14                0.109018         164.499741            1       True   
 15                1.526517          17.218405            1       True   
 16                7.014914          44.744902            1       True   
 17                0.622713          27.364055            1       True   
 18                0.520396          51.495713            1       True   
 
     fit_order  
 0          19  
 1          17  
 2          14  
 3          16  
 4          18  
 5          13  
 6          15  
 7          12  
 8           2  
 9          11  
 10          1  
 11          5  
 12          7  
 13         10  
 14          6  
 15          4  
 16          3  
 17          9  
 18          8  }</code></pre>
</div>
</div>
<section id="create-predictions-from-test-dataset" class="cell markdown" data-tags="[]">
<h3>Create predictions from test dataset</h3>
</section>
<div class="cell code" data-execution_count="11" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:55:29.327599Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:55:29.328233Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:56:11.867887Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:55:29.328276Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:56:11.866441Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>predictor.leaderboard(train, silent<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">
<style type='text/css'>
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .bool    { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .int     { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .str     { background: #CC4040; }
.datatable .time    { background: #40CC40; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tbody td { text-align: left; }
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .sp {  opacity: 0.25;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style>

</div>
<div class="output execute_result" data-execution_count="11">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>score_test</th>
      <th>score_val</th>
      <th>pred_time_test</th>
      <th>pred_time_val</th>
      <th>fit_time</th>
      <th>pred_time_test_marginal</th>
      <th>pred_time_val_marginal</th>
      <th>fit_time_marginal</th>
      <th>stack_level</th>
      <th>can_infer</th>
      <th>fit_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KNeighborsDist_BAG_L1</td>
      <td>-0.000000</td>
      <td>-84.139994</td>
      <td>0.044035</td>
      <td>0.040388</td>
      <td>0.023303</td>
      <td>0.044035</td>
      <td>0.040388</td>
      <td>0.023303</td>
      <td>1</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WeightedEnsemble_L2</td>
      <td>-0.000000</td>
      <td>-84.139994</td>
      <td>0.047091</td>
      <td>0.041315</td>
      <td>0.639719</td>
      <td>0.003055</td>
      <td>0.000927</td>
      <td>0.616416</td>
      <td>2</td>
      <td>True</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RandomForestMSE_BAG_L1</td>
      <td>-42.938321</td>
      <td>-116.544294</td>
      <td>1.373513</td>
      <td>0.631336</td>
      <td>6.091171</td>
      <td>1.373513</td>
      <td>0.631336</td>
      <td>6.091171</td>
      <td>1</td>
      <td>True</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ExtraTreesMSE_BAG_L1</td>
      <td>-45.919556</td>
      <td>-124.588053</td>
      <td>0.511552</td>
      <td>0.595327</td>
      <td>2.939291</td>
      <td>0.511552</td>
      <td>0.595327</td>
      <td>2.939291</td>
      <td>1</td>
      <td>True</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ExtraTreesMSE_BAG_L2</td>
      <td>-63.047560</td>
      <td>-54.132970</td>
      <td>30.377687</td>
      <td>12.675121</td>
      <td>340.703768</td>
      <td>0.606799</td>
      <td>0.715379</td>
      <td>5.164482</td>
      <td>2</td>
      <td>True</td>
      <td>16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>KNeighborsUnif_BAG_L1</td>
      <td>-70.695972</td>
      <td>-101.573722</td>
      <td>0.080673</td>
      <td>0.040659</td>
      <td>0.413787</td>
      <td>0.080673</td>
      <td>0.040659</td>
      <td>0.413787</td>
      <td>1</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RandomForestMSE_BAG_L2</td>
      <td>-74.297356</td>
      <td>-53.146724</td>
      <td>30.364108</td>
      <td>12.665522</td>
      <td>352.662355</td>
      <td>0.593219</td>
      <td>0.705780</td>
      <td>17.123069</td>
      <td>2</td>
      <td>True</td>
      <td>14</td>
    </tr>
    <tr>
      <th>7</th>
      <td>LightGBMLarge_BAG_L1</td>
      <td>-78.237433</td>
      <td>-130.132290</td>
      <td>2.342972</td>
      <td>0.858475</td>
      <td>20.748918</td>
      <td>2.342972</td>
      <td>0.858475</td>
      <td>20.748918</td>
      <td>1</td>
      <td>True</td>
      <td>10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>XGBoost_BAG_L2</td>
      <td>-79.314604</td>
      <td>-54.808817</td>
      <td>30.392734</td>
      <td>12.267464</td>
      <td>351.859463</td>
      <td>0.621845</td>
      <td>0.307722</td>
      <td>16.320178</td>
      <td>2</td>
      <td>True</td>
      <td>18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>XGBoost_BAG_L1</td>
      <td>-85.623725</td>
      <td>-131.624665</td>
      <td>1.403127</td>
      <td>0.622713</td>
      <td>27.364055</td>
      <td>1.403127</td>
      <td>0.622713</td>
      <td>27.364055</td>
      <td>1</td>
      <td>True</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>LightGBM_BAG_L2</td>
      <td>-86.150083</td>
      <td>-54.957749</td>
      <td>30.419085</td>
      <td>12.409572</td>
      <td>351.505109</td>
      <td>0.648196</td>
      <td>0.449830</td>
      <td>15.965823</td>
      <td>2</td>
      <td>True</td>
      <td>13</td>
    </tr>
    <tr>
      <th>11</th>
      <td>CatBoost_BAG_L1</td>
      <td>-87.919916</td>
      <td>-130.461205</td>
      <td>0.337536</td>
      <td>0.109018</td>
      <td>164.499741</td>
      <td>0.337536</td>
      <td>0.109018</td>
      <td>164.499741</td>
      <td>1</td>
      <td>True</td>
      <td>6</td>
    </tr>
    <tr>
      <th>12</th>
      <td>LightGBM_BAG_L1</td>
      <td>-90.570763</td>
      <td>-131.054162</td>
      <td>4.025875</td>
      <td>1.526517</td>
      <td>17.218405</td>
      <td>4.025875</td>
      <td>1.526517</td>
      <td>17.218405</td>
      <td>1</td>
      <td>True</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>LightGBMXT_BAG_L1</td>
      <td>-97.172702</td>
      <td>-131.460909</td>
      <td>17.975313</td>
      <td>7.014914</td>
      <td>44.744902</td>
      <td>17.975313</td>
      <td>7.014914</td>
      <td>44.744902</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>LightGBMXT_BAG_L2</td>
      <td>-97.914041</td>
      <td>-60.077859</td>
      <td>38.157184</td>
      <td>15.203234</td>
      <td>370.599327</td>
      <td>8.386295</td>
      <td>3.243492</td>
      <td>35.060041</td>
      <td>2</td>
      <td>True</td>
      <td>12</td>
    </tr>
    <tr>
      <th>15</th>
      <td>CatBoost_BAG_L2</td>
      <td>-111.946162</td>
      <td>-55.575874</td>
      <td>29.881129</td>
      <td>12.030076</td>
      <td>385.620627</td>
      <td>0.110240</td>
      <td>0.070334</td>
      <td>50.081342</td>
      <td>2</td>
      <td>True</td>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NeuralNetFastAI_BAG_L1</td>
      <td>-126.921180</td>
      <td>-136.000551</td>
      <td>1.676293</td>
      <td>0.520396</td>
      <td>51.495713</td>
      <td>1.676293</td>
      <td>0.520396</td>
      <td>51.495713</td>
      <td>1</td>
      <td>True</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>WeightedEnsemble_L3</td>
      <td>-136.708629</td>
      <td>-50.788422</td>
      <td>32.666221</td>
      <td>13.949337</td>
      <td>411.697326</td>
      <td>0.005372</td>
      <td>0.001314</td>
      <td>0.664790</td>
      <td>3</td>
      <td>True</td>
      <td>19</td>
    </tr>
    <tr>
      <th>18</th>
      <td>NeuralNetFastAI_BAG_L2</td>
      <td>-205.272389</td>
      <td>-52.021372</td>
      <td>31.460831</td>
      <td>12.526864</td>
      <td>388.744984</td>
      <td>1.689943</td>
      <td>0.567122</td>
      <td>53.205698</td>
      <td>2</td>
      <td>True</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="12" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:56:20.056893Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:56:20.057826Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:56:40.350336Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:56:20.057879Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:56:40.349352Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>predictions.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>0    24.407570
1    41.372566
2    46.059689
3    48.783813
4    51.217506
Name: count, dtype: float32</code></pre>
</div>
</div>
<section id="note-kaggle-will-reject-the-submission-if-we-dont-set-everything-to-be--0" class="cell markdown">
<h4>NOTE: Kaggle will reject the submission if we don't set everything to be &gt; 0.</h4>
</section>
<div class="cell code" data-execution_count="13" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:56:46.865849Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:56:46.866284Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:56:46.881401Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:56:46.866326Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:56:46.879988Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the `predictions` series to see if there are any negative values</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>predictions.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<pre><code>count    6493.000000
mean       99.568642
std        88.215355
min         0.120696
25%        20.397356
50%        65.873886
75%       167.185699
max       353.918640
Name: count, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="14" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:56:51.389448Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:56:51.390730Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:56:51.400833Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:56:51.390782Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:56:51.399510Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>predictions</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>0        24.407570
1        41.372566
2        46.059689
3        48.783813
4        51.217506
           ...    
6488    166.105057
6489    166.108200
6490    164.193054
6491    155.035767
6492    155.149078
Name: count, Length: 6493, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:56:57.485899Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:56:57.486342Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:56:57.495553Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:56:57.486384Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:56:57.494268Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many negative values do we have?</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>predictions[predictions<span class="op">&lt;</span><span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<pre><code>Series([], Name: count, dtype: float32)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:57:00.087688Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:57:00.088540Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:57:00.096501Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:57:00.088580Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:57:00.095602Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set them to zero</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>predictions[predictions<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:57:02.798772Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:57:02.799254Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:57:02.809312Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:57:02.799290Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:57:02.808119Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>predictions</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>0        24.407570
1        41.372566
2        46.059689
3        48.783813
4        51.217506
           ...    
6488    166.105057
6489    166.108200
6490    164.193054
6491    155.035767
6492    155.149078
Name: count, Length: 6493, dtype: float32</code></pre>
</div>
</div>
<section id="set-predictions-to-submission-dataframe-save-and-submit" class="cell markdown">
<h3>Set predictions to submission dataframe, save, and submit</h3>
</section>
<div class="cell code" data-execution_count="18" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:57:06.234066Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:57:06.234470Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:57:06.267558Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:57:06.234507Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:57:06.266195Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>submission[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>submission.to_csv(<span class="st">&quot;submission.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:57:09.872805Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:57:09.873246Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:57:13.011975Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:57:09.873295Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:57:13.010541Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission.csv <span class="op">-</span>m <span class="st">&quot;first raw submission&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188k/188k [00:00&lt;00:00, 942kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<section id="view-submission-via-the-command-line-or-in-the-web-browser-under-the-competitions-page---my-submissions" class="cell markdown">
<h4>View submission via the command line or in the web browser under the competition's page - <code>My Submissions</code></h4>
</section>
<div class="cell code" data-execution_count="20" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:57:18.965807Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:57:18.966276Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:57:20.941848Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:57:18.966320Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:57:20.939993Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                                                                                                                                                                                           status    publicScore  privateScore  
---------------------------  -------------------  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------  --------  -----------  ------------  
submission.csv               2023-01-01 03:57:11  first raw submission                                                                                                                                                                                  complete  1.81002      1.81002       
submission_new_hpo.csv       2022-12-31 22:24:57  new features with hyperparameters                                                                                                                                                                     complete  0.47101      0.47101       
submission_new_features.csv  2022-12-31 22:20:49  new features                                                                                                                                                                                          complete  0.45311      0.45311       
submission.csv               2022-12-31 22:10:01  first raw submission                                                                                                                                                                                  complete  1.78543      1.78543       
tail: write error: Broken pipe
</code></pre>
</div>
</div>
<section id="initial-score-of-181002" class="cell markdown">
<h4>Initial score of <code>1.81002</code></h4>
</section>
<section id="step-4-exploratory-data-analysis-and-creating-an-additional-feature" class="cell markdown">
<h2>Step 4: Exploratory Data Analysis and Creating an additional feature</h2>
<ul>
<li>Any additional feature will do, but a great suggestion would be to separate out the datetime into hour, day, or month parts.</li>
</ul>
</section>
<div class="cell code" data-execution_count="21" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:58:26.340279Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:58:26.341591Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:58:28.006577Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:58:26.341659Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:58:28.005312Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram of all features to show the distribution of each one relative to the data. This is part of the exploritory data analysis</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>train.hist()</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">
<pre><code>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;datetime&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;season&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;holiday&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;workingday&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;weather&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;temp&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;atemp&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;humidity&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;windspeed&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;count&#39;}&gt;, &lt;AxesSubplot:&gt;,
        &lt;AxesSubplot:&gt;]], dtype=object)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/f55d403fbbc188eb3f3ca7fbdab03ab92d72689f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="22" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:05.968822Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:05.969245Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:05.990438Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:05.969283Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:05.989059Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>train.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 10 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   datetime    10886 non-null  datetime64[ns]
 1   season      10886 non-null  int64         
 2   holiday     10886 non-null  int64         
 3   workingday  10886 non-null  int64         
 4   weather     10886 non-null  int64         
 5   temp        10886 non-null  float64       
 6   atemp       10886 non-null  float64       
 7   humidity    10886 non-null  int64         
 8   windspeed   10886 non-null  float64       
 9   count       10886 non-null  int64         
dtypes: datetime64[ns](1), float64(3), int64(6)
memory usage: 850.6 KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:08.946677Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:08.947066Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:08.965032Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:08.947102Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:08.964138Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="24" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:11.775009Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:11.775856Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:11.863032Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:11.775904Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:11.861406Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new feature</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;year&quot;</span>] <span class="op">=</span> pd.to_datetime(train[<span class="st">&quot;datetime&quot;</span>]).dt.year</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> pd.to_datetime(train[<span class="st">&quot;datetime&quot;</span>]).dt.month</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;day&quot;</span>] <span class="op">=</span> pd.to_datetime(train[<span class="st">&quot;datetime&quot;</span>]).dt.day</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;hour&quot;</span>] <span class="op">=</span> pd.to_datetime(train[<span class="st">&quot;datetime&quot;</span>]).dt.hour</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;year&quot;</span>] <span class="op">=</span> pd.to_datetime(test[<span class="st">&quot;datetime&quot;</span>]).dt.year</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;month&quot;</span>] <span class="op">=</span> pd.to_datetime(test[<span class="st">&quot;datetime&quot;</span>]).dt.month</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;day&quot;</span>] <span class="op">=</span> pd.to_datetime(test[<span class="st">&quot;datetime&quot;</span>]).dt.day</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;hour&quot;</span>] <span class="op">=</span> pd.to_datetime(test[<span class="st">&quot;datetime&quot;</span>]).dt.hour</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="25" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:14.174531Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:14.175929Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:14.196146Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:14.175991Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:14.194971Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>13</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>1</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="26" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:16.750534Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:16.750982Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:16.770789Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:16.751024Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:16.769315Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>11.365</td>
      <td>56</td>
      <td>26.0027</td>
      <td>2011</td>
      <td>1</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
      <td>2011</td>
      <td>1</td>
      <td>20</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
      <td>2011</td>
      <td>1</td>
      <td>20</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
      <td>2011</td>
      <td>1</td>
      <td>20</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
      <td>2011</td>
      <td>1</td>
      <td>20</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="make-category-types-for-these-so-models-know-they-are-not-just-numbers" class="cell markdown">
<h2>Make category types for these so models know they are not just numbers</h2>
<ul>
<li>AutoGluon originally sees these as ints, but in reality they are int representations of a category.</li>
<li>Setting the dtype to category will classify these as categories in AutoGluon.</li>
</ul>
</section>
<div class="cell code" data-execution_count="27" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:20.622096Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:20.622510Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:20.637517Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:20.622548Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:20.635508Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;season&quot;</span>] <span class="op">=</span> train.season.astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&quot;weather&quot;</span>] <span class="op">=</span> train.weather.astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;season&quot;</span>] <span class="op">=</span> test.season.astype(<span class="st">&quot;category&quot;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&quot;weather&quot;</span>] <span class="op">=</span> test.weather.astype(<span class="st">&quot;category&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:23.150499Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:23.150916Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:23.168800Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:23.150951Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:23.167740Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>train.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 14 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   datetime    10886 non-null  datetime64[ns]
 1   season      10886 non-null  category      
 2   holiday     10886 non-null  int64         
 3   workingday  10886 non-null  int64         
 4   weather     10886 non-null  category      
 5   temp        10886 non-null  float64       
 6   atemp       10886 non-null  float64       
 7   humidity    10886 non-null  int64         
 8   windspeed   10886 non-null  float64       
 9   count       10886 non-null  int64         
 10  year        10886 non-null  int64         
 11  month       10886 non-null  int64         
 12  day         10886 non-null  int64         
 13  hour        10886 non-null  int64         
dtypes: category(2), datetime64[ns](1), float64(3), int64(8)
memory usage: 1.0 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:25.590845Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:25.591518Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:25.609408Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:25.591559Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:25.608240Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>test.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6493 entries, 0 to 6492
Data columns (total 13 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   datetime    6493 non-null   datetime64[ns]
 1   season      6493 non-null   category      
 2   holiday     6493 non-null   int64         
 3   workingday  6493 non-null   int64         
 4   weather     6493 non-null   category      
 5   temp        6493 non-null   float64       
 6   atemp       6493 non-null   float64       
 7   humidity    6493 non-null   int64         
 8   windspeed   6493 non-null   float64       
 9   year        6493 non-null   int64         
 10  month       6493 non-null   int64         
 11  day         6493 non-null   int64         
 12  hour        6493 non-null   int64         
dtypes: category(2), datetime64[ns](1), float64(3), int64(7)
memory usage: 571.2 KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="30" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:28.606698Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:28.607495Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:28.627444Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:28.607537Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:28.625897Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View are new feature</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>13</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>1</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="31" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T03:59:30.907539Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T03:59:30.908005Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T03:59:32.380058Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T03:59:30.908046Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T03:59:32.378711Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View histogram of all features again now with the hour feature</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>train.hist()</span></code></pre></div>
<div class="output execute_result" data-execution_count="31">
<pre><code>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;datetime&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;holiday&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;workingday&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;temp&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;atemp&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;humidity&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;windspeed&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;count&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;year&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;month&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;day&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;hour&#39;}&gt;]], dtype=object)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/c0fbeb9d7051d116d1b54bbc53954cbbc95a0258.png" /></p>
</div>
</div>
<section id="step-5-rerun-the-model-with-the-same-settings-as-before-just-with-more-features" class="cell markdown">
<h2>Step 5: Rerun the model with the same settings as before, just with more features</h2>
</section>
<div class="cell code" data-execution_count="32" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:00:10.592532Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:00:10.593011Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:10:22.584673Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:00:10.593053Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:10:22.583183Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&quot;count&quot;</span>, problem_type<span class="op">=</span><span class="st">&quot;regression&quot;</span>, eval_metric<span class="op">=</span><span class="st">&quot;root_mean_squared_error&quot;</span>).fit(train_data<span class="op">=</span>train, time_limit<span class="op">=</span><span class="dv">600</span>, presets<span class="op">=</span><span class="st">&quot;best_quality&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230101_040010/&quot;
Presets specified: [&#39;best_quality&#39;]
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230101_040010/&quot;
AutoGluon Version:  0.6.1
Python Version:     3.7.12
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Sat Dec 10 10:12:26 UTC 2022
Train Data Rows:    10886
Train Data Columns: 13
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    31100.53 MB
	Train Data (Original)  Memory Usage: 0.98 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 3 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting CategoryFeatureGenerator...
			Fitting CategoryMemoryMinimizeFeatureGenerator...
		Fitting DatetimeFeatureGenerator...
/opt/conda/lib/python3.7/site-packages/autogluon/features/generators/datetime.py:59: FutureWarning: casting datetime64[ns, UTC] values to int64 with .astype(...) is deprecated and will raise in a future version. Use .view(...) instead.
  good_rows = series[~series.isin(bad_rows)].astype(np.int64)
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;category&#39;, []) : 2 | [&#39;season&#39;, &#39;weather&#39;]
		(&#39;datetime&#39;, []) : 1 | [&#39;datetime&#39;]
		(&#39;float&#39;, [])    : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])      : 7 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;humidity&#39;, &#39;year&#39;, &#39;month&#39;, ...]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;category&#39;, [])             : 2 | [&#39;season&#39;, &#39;weather&#39;]
		(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])                  : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
		(&#39;int&#39;, [&#39;bool&#39;])            : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
		(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
	0.3s = Fit runtime
	13 features in original data used to generate 17 features in processed data.
	Train Data (Processed) Memory Usage: 1.1 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.35s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 11 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 399.67s of the 599.64s of remaining time.
	-183.4072	 = Validation score   (-root_mean_squared_error)
	0.02s	 = Training   runtime
	0.92s	 = Validation runtime
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 398.65s of the 598.63s of remaining time.
	-183.4072	 = Validation score   (-root_mean_squared_error)
	0.01s	 = Training   runtime
	1.01s	 = Validation runtime
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 397.56s of the 597.54s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-34.346	 = Validation score   (-root_mean_squared_error)
	57.95s	 = Training   runtime
	9.7s	 = Validation runtime
Fitting model: LightGBM_BAG_L1 ... Training model for up to 332.27s of the 532.25s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-33.9173	 = Validation score   (-root_mean_squared_error)
	31.23s	 = Training   runtime
	3.21s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L1 ... Training model for up to 294.97s of the 494.95s of remaining time.
	-38.3149	 = Validation score   (-root_mean_squared_error)
	7.56s	 = Training   runtime
	0.66s	 = Validation runtime
Fitting model: CatBoost_BAG_L1 ... Training model for up to 286.19s of the 486.17s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-33.5038	 = Validation score   (-root_mean_squared_error)
	235.54s	 = Training   runtime
	0.28s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L1 ... Training model for up to 45.59s of the 245.57s of remaining time.
	-38.2952	 = Validation score   (-root_mean_squared_error)
	4.18s	 = Training   runtime
	0.64s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L1 ... Training model for up to 40.3s of the 240.27s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-50.2266	 = Validation score   (-root_mean_squared_error)
	41.6s	 = Training   runtime
	0.52s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 193.66s of remaining time.
	-32.1039	 = Validation score   (-root_mean_squared_error)
	0.53s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 9 L2 models ...
Fitting model: LightGBMXT_BAG_L2 ... Training model for up to 193.12s of the 193.11s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-33.0129	 = Validation score   (-root_mean_squared_error)
	15.69s	 = Training   runtime
	0.34s	 = Validation runtime
Fitting model: LightGBM_BAG_L2 ... Training model for up to 171.96s of the 171.95s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-32.271	 = Validation score   (-root_mean_squared_error)
	13.42s	 = Training   runtime
	0.15s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L2 ... Training model for up to 152.97s of the 152.96s of remaining time.
	-32.4757	 = Validation score   (-root_mean_squared_error)
	17.91s	 = Training   runtime
	0.71s	 = Validation runtime
Fitting model: CatBoost_BAG_L2 ... Training model for up to 133.8s of the 133.79s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-32.1807	 = Validation score   (-root_mean_squared_error)
	46.4s	 = Training   runtime
	0.13s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L2 ... Training model for up to 82.31s of the 82.29s of remaining time.
	-32.0854	 = Validation score   (-root_mean_squared_error)
	5.67s	 = Training   runtime
	0.69s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L2 ... Training model for up to 75.49s of the 75.47s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-32.4333	 = Validation score   (-root_mean_squared_error)
	55.71s	 = Training   runtime
	0.54s	 = Validation runtime
Fitting model: XGBoost_BAG_L2 ... Training model for up to 14.71s of the 14.69s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-32.7681	 = Validation score   (-root_mean_squared_error)
	19.91s	 = Training   runtime
	0.3s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the -11.11s of remaining time.
	-31.7798	 = Validation score   (-root_mean_squared_error)
	0.81s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 611.95s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230101_040010/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="33" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:10:39.223040Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:10:39.223518Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:10:39.279064Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:10:39.223565Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:10:39.277775Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -31.779829      19.141258  517.999887                0.001135           0.806002            3       True         17
1     ExtraTreesMSE_BAG_L2  -32.085406      17.617849  383.755693                0.690969           5.665031            2       True         14
2      WeightedEnsemble_L2  -32.103941      13.848041  332.807350                0.000980           0.525932            2       True          9
3          CatBoost_BAG_L2  -32.180717      17.059448  424.487636                0.132568          46.396973            2       True         13
4          LightGBM_BAG_L2  -32.270997      17.074370  391.510566                0.147489          13.419904            2       True         11
5   NeuralNetFastAI_BAG_L2  -32.433285      17.462123  433.801768                0.535243          55.711106            2       True         15
6   RandomForestMSE_BAG_L2  -32.475723      17.633854  396.000870                0.706974          17.910208            2       True         12
7           XGBoost_BAG_L2  -32.768099      17.231520  397.999769                0.304639          19.909107            2       True         16
8        LightGBMXT_BAG_L2  -33.012939      17.267044  393.781599                0.340164          15.690937            2       True         10
9          CatBoost_BAG_L1  -33.503820       0.279584  235.542939                0.279584         235.542939            1       True          6
10         LightGBM_BAG_L1  -33.917339       3.205434   31.227652                3.205434          31.227652            1       True          4
11       LightGBMXT_BAG_L1  -34.345997       9.704391   57.948305                9.704391          57.948305            1       True          3
12    ExtraTreesMSE_BAG_L1  -38.295243       0.635653    4.179888                0.635653           4.179888            1       True          7
13  RandomForestMSE_BAG_L1  -38.314947       0.657652    7.562522                0.657652           7.562522            1       True          5
14  NeuralNetFastAI_BAG_L1  -50.226582       0.519375   41.596031                0.519375          41.596031            1       True          8
15   KNeighborsUnif_BAG_L1 -183.407182       0.917064    0.018683                0.917064           0.018683            1       True          1
16   KNeighborsDist_BAG_L1 -183.407182       1.007728    0.014642                1.007728           0.014642            1       True          2
Number of models trained: 17
Types of models trained:
{&#39;StackerEnsembleModel_RF&#39;, &#39;StackerEnsembleModel_XGBoost&#39;, &#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_LGB&#39;, &#39;StackerEnsembleModel_NNFastAiTabular&#39;, &#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_KNN&#39;, &#39;StackerEnsembleModel_CatBoost&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;category&#39;, [])             : 2 | [&#39;season&#39;, &#39;weather&#39;]
(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])                  : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;])            : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="33">
<pre><code>{&#39;model_types&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L2&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;XGBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_XGBoost&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: -183.40718249649234,
  &#39;KNeighborsDist_BAG_L1&#39;: -183.40718249649234,
  &#39;LightGBMXT_BAG_L1&#39;: -34.34599701170154,
  &#39;LightGBM_BAG_L1&#39;: -33.91733862651761,
  &#39;RandomForestMSE_BAG_L1&#39;: -38.31494666065859,
  &#39;CatBoost_BAG_L1&#39;: -33.503820059633895,
  &#39;ExtraTreesMSE_BAG_L1&#39;: -38.29524277410234,
  &#39;NeuralNetFastAI_BAG_L1&#39;: -50.2265815926291,
  &#39;WeightedEnsemble_L2&#39;: -32.1039411947156,
  &#39;LightGBMXT_BAG_L2&#39;: -33.012938800986774,
  &#39;LightGBM_BAG_L2&#39;: -32.27099667623387,
  &#39;RandomForestMSE_BAG_L2&#39;: -32.475723399321545,
  &#39;CatBoost_BAG_L2&#39;: -32.180717227038485,
  &#39;ExtraTreesMSE_BAG_L2&#39;: -32.08540640004396,
  &#39;NeuralNetFastAI_BAG_L2&#39;: -32.43328500344621,
  &#39;XGBoost_BAG_L2&#39;: -32.76809881486433,
  &#39;WeightedEnsemble_L3&#39;: -31.779828554302405},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/KNeighborsUnif_BAG_L1/&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/KNeighborsDist_BAG_L1/&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/LightGBMXT_BAG_L1/&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/LightGBM_BAG_L1/&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/RandomForestMSE_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/CatBoost_BAG_L1/&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/ExtraTreesMSE_BAG_L1/&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_040010/models/NeuralNetFastAI_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/LightGBMXT_BAG_L2/&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/LightGBM_BAG_L2/&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/RandomForestMSE_BAG_L2/&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/CatBoost_BAG_L2/&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/ExtraTreesMSE_BAG_L2/&#39;,
  &#39;NeuralNetFastAI_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/NeuralNetFastAI_BAG_L2/&#39;,
  &#39;XGBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_040010/models/XGBoost_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230101_040010/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.018683195114135742,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.014641523361206055,
  &#39;LightGBMXT_BAG_L1&#39;: 57.948304891586304,
  &#39;LightGBM_BAG_L1&#39;: 31.227651834487915,
  &#39;RandomForestMSE_BAG_L1&#39;: 7.5625221729278564,
  &#39;CatBoost_BAG_L1&#39;: 235.5429391860962,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 4.179888010025024,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 41.59603142738342,
  &#39;WeightedEnsemble_L2&#39;: 0.5259318351745605,
  &#39;LightGBMXT_BAG_L2&#39;: 15.690937042236328,
  &#39;LightGBM_BAG_L2&#39;: 13.419903993606567,
  &#39;RandomForestMSE_BAG_L2&#39;: 17.910208225250244,
  &#39;CatBoost_BAG_L2&#39;: 46.39697337150574,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 5.6650309562683105,
  &#39;NeuralNetFastAI_BAG_L2&#39;: 55.71110558509827,
  &#39;XGBoost_BAG_L2&#39;: 19.909106731414795,
  &#39;WeightedEnsemble_L3&#39;: 0.806002140045166},
 &#39;model_pred_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.9170641899108887,
  &#39;KNeighborsDist_BAG_L1&#39;: 1.0077276229858398,
  &#39;LightGBMXT_BAG_L1&#39;: 9.704391241073608,
  &#39;LightGBM_BAG_L1&#39;: 3.2054336071014404,
  &#39;RandomForestMSE_BAG_L1&#39;: 0.6576519012451172,
  &#39;CatBoost_BAG_L1&#39;: 0.2795839309692383,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 0.6356525421142578,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 0.5193753242492676,
  &#39;WeightedEnsemble_L2&#39;: 0.000980377197265625,
  &#39;LightGBMXT_BAG_L2&#39;: 0.3401637077331543,
  &#39;LightGBM_BAG_L2&#39;: 0.14748930931091309,
  &#39;RandomForestMSE_BAG_L2&#39;: 0.7069737911224365,
  &#39;CatBoost_BAG_L2&#39;: 0.1325676441192627,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 0.6909687519073486,
  &#39;NeuralNetFastAI_BAG_L2&#39;: 0.535243034362793,
  &#39;XGBoost_BAG_L2&#39;: 0.3046393394470215,
  &#39;WeightedEnsemble_L3&#39;: 0.0011353492736816406},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;KNeighborsDist_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;LightGBMXT_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMXT_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;XGBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model   score_val  pred_time_val    fit_time  \
 0      WeightedEnsemble_L3  -31.779829      19.141258  517.999887   
 1     ExtraTreesMSE_BAG_L2  -32.085406      17.617849  383.755693   
 2      WeightedEnsemble_L2  -32.103941      13.848041  332.807350   
 3          CatBoost_BAG_L2  -32.180717      17.059448  424.487636   
 4          LightGBM_BAG_L2  -32.270997      17.074370  391.510566   
 5   NeuralNetFastAI_BAG_L2  -32.433285      17.462123  433.801768   
 6   RandomForestMSE_BAG_L2  -32.475723      17.633854  396.000870   
 7           XGBoost_BAG_L2  -32.768099      17.231520  397.999769   
 8        LightGBMXT_BAG_L2  -33.012939      17.267044  393.781599   
 9          CatBoost_BAG_L1  -33.503820       0.279584  235.542939   
 10         LightGBM_BAG_L1  -33.917339       3.205434   31.227652   
 11       LightGBMXT_BAG_L1  -34.345997       9.704391   57.948305   
 12    ExtraTreesMSE_BAG_L1  -38.295243       0.635653    4.179888   
 13  RandomForestMSE_BAG_L1  -38.314947       0.657652    7.562522   
 14  NeuralNetFastAI_BAG_L1  -50.226582       0.519375   41.596031   
 15   KNeighborsUnif_BAG_L1 -183.407182       0.917064    0.018683   
 16   KNeighborsDist_BAG_L1 -183.407182       1.007728    0.014642   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.001135           0.806002            3       True   
 1                 0.690969           5.665031            2       True   
 2                 0.000980           0.525932            2       True   
 3                 0.132568          46.396973            2       True   
 4                 0.147489          13.419904            2       True   
 5                 0.535243          55.711106            2       True   
 6                 0.706974          17.910208            2       True   
 7                 0.304639          19.909107            2       True   
 8                 0.340164          15.690937            2       True   
 9                 0.279584         235.542939            1       True   
 10                3.205434          31.227652            1       True   
 11                9.704391          57.948305            1       True   
 12                0.635653           4.179888            1       True   
 13                0.657652           7.562522            1       True   
 14                0.519375          41.596031            1       True   
 15                0.917064           0.018683            1       True   
 16                1.007728           0.014642            1       True   
 
     fit_order  
 0          17  
 1          14  
 2           9  
 3          13  
 4          11  
 5          15  
 6          12  
 7          16  
 8          10  
 9           6  
 10          4  
 11          3  
 12          7  
 13          5  
 14          8  
 15          1  
 16          2  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:00.936370Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:00.936806Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:25.031854Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:00.936849Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:25.030699Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>predictions_new_features <span class="op">=</span> predictor_new_features.predict(test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="35" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:28.266661Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:28.267061Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:28.276680Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:28.267096Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:28.275397Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>predictions_new_features.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="35">
<pre><code>0    11.696628
1     4.717339
2     3.405050
3     2.850586
4     3.006395
Name: count, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="36" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:31.250064Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:31.251253Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:31.264132Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:31.251298Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:31.262856Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>predictions_new_features.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="36">
<pre><code>count    6493.000000
mean      190.442627
std       173.725540
min         0.464051
25%        45.923553
50%       147.853729
75%       280.282471
max       897.022461
Name: count, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="37" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:37.224297Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:37.224745Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:37.237147Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:37.224782Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:37.233262Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>predictions_new_features[predictions_new_features<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="38" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:39.487401Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:39.488211Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:39.496885Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:39.488253Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:39.495670Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>predictions_new_features[predictions_new_features<span class="op">&lt;</span><span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<pre><code>Series([], Name: count, dtype: float32)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="39" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:43.035882Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:43.036301Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:43.056771Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:43.036348Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:43.055391Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>submission_new_features <span class="op">=</span> pd.read_csv(<span class="st">&quot;sampleSubmission.csv&quot;</span>, parse_dates<span class="op">=</span>[<span class="st">&quot;datetime&quot;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="40" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:45.444522Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:45.444982Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:45.474455Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:45.445022Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:45.473112Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>submission_new_features[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_features</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>submission_new_features.to_csv(<span class="st">&quot;submission_new_features.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="41" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:49.718455Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:49.719138Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:49.731188Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:49.719184Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:49.729915Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>submission_new_features.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>11.696628</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>4.717339</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>3.405050</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>2.850586</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>3.006395</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="42" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:53.120866Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:53.121338Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:11:56.289577Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:53.121381Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:11:56.288272Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_features.csv <span class="op">-</span>m <span class="st">&quot;new features&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188k/188k [00:00&lt;00:00, 938kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="43" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:11:59.318325Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:11:59.318804Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:12:01.175521Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:11:59.318854Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:12:01.173790Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                                                                                                                                                                                           status    publicScore  privateScore  
---------------------------  -------------------  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------  --------  -----------  ------------  
submission_new_features.csv  2023-01-01 04:11:55  new features                                                                                                                                                                                          complete  0.45275      0.45275       
submission.csv               2023-01-01 03:57:11  first raw submission                                                                                                                                                                                  complete  1.81002      1.81002       
submission_new_hpo.csv       2022-12-31 22:24:57  new features with hyperparameters                                                                                                                                                                     complete  0.47101      0.47101       
submission_new_features.csv  2022-12-31 22:20:49  new features                                                                                                                                                                                          complete  0.45311      0.45311       
tail: write error: Broken pipe
</code></pre>
</div>
</div>
<section id="new-score-of-045275" class="cell markdown">
<h4>New Score of <code>0.45275</code></h4>
</section>
<section id="step-6-hyper-parameter-optimization" class="cell markdown">
<h2>Step 6: Hyper parameter optimization</h2>
<ul>
<li>There are many options for hyper parameter optimization.</li>
<li>Options are to change the AutoGluon higher level parameters or the individual model hyperparameters.</li>
<li>The hyperparameters of the models themselves that are in AutoGluon. Those need the <code>hyperparameter</code> and <code>hyperparameter_tune_kwargs</code> arguments.</li>
</ul>
</section>
<div class="cell code" data-execution_count="44" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:14:30.166891Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:14:30.167423Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:18:28.047196Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:14:30.167470Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:18:28.045993Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&quot;count&quot;</span>, problem_type<span class="op">=</span><span class="st">&quot;regression&quot;</span>, eval_metric<span class="op">=</span><span class="st">&quot;root_mean_squared_error&quot;</span>).fit(train_data<span class="op">=</span>train, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                                                                                                                          time_limit<span class="op">=</span><span class="dv">600</span>, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                                                                                                          presets<span class="op">=</span><span class="st">&quot;best_quality&quot;</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                                                                                                                          hyperparameters<span class="op">=</span>{<span class="st">&#39;CAT&#39;</span>: {<span class="st">&#39;iterations&#39;</span>: <span class="dv">10000</span>},</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                                                                                                                                           <span class="st">&#39;RF&#39;</span>: {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">300</span>},</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                                                                                                                                           <span class="st">&#39;XT&#39;</span>: {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">300</span>}},</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                                                                                                                          hyperparameter_tune_kwargs<span class="op">=</span><span class="st">&quot;auto&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230101_041430/&quot;
Presets specified: [&#39;best_quality&#39;]
Warning: hyperparameter tuning is currently experimental and may cause the process to hang.
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230101_041430/&quot;
AutoGluon Version:  0.6.1
Python Version:     3.7.12
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Sat Dec 10 10:12:26 UTC 2022
Train Data Rows:    10886
Train Data Columns: 13
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    31066.13 MB
	Train Data (Original)  Memory Usage: 0.98 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 3 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting CategoryFeatureGenerator...
			Fitting CategoryMemoryMinimizeFeatureGenerator...
		Fitting DatetimeFeatureGenerator...
/opt/conda/lib/python3.7/site-packages/autogluon/features/generators/datetime.py:59: FutureWarning: casting datetime64[ns, UTC] values to int64 with .astype(...) is deprecated and will raise in a future version. Use .view(...) instead.
  good_rows = series[~series.isin(bad_rows)].astype(np.int64)
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;category&#39;, []) : 2 | [&#39;season&#39;, &#39;weather&#39;]
		(&#39;datetime&#39;, []) : 1 | [&#39;datetime&#39;]
		(&#39;float&#39;, [])    : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])      : 7 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;humidity&#39;, &#39;year&#39;, &#39;month&#39;, ...]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;category&#39;, [])             : 2 | [&#39;season&#39;, &#39;weather&#39;]
		(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])                  : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
		(&#39;int&#39;, [&#39;bool&#39;])            : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
		(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
	0.2s = Fit runtime
	13 features in original data used to generate 17 features in processed data.
	Train Data (Processed) Memory Usage: 1.1 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.24s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 3 L1 models ...
Hyperparameter tuning model: RandomForest_BAG_L1 ... Tuning model for up to 119.92s of the 599.75s of remaining time.
	No hyperparameter search space specified for RandomForest_BAG_L1. Skipping HPO. Will train one model based on the provided hyperparameters.
Fitted model: RandomForest_BAG_L1 ...
	-38.3149	 = Validation score   (-root_mean_squared_error)
	9.51s	 = Training   runtime
	0.0s	 = Validation runtime
Hyperparameter tuning model: CatBoost_BAG_L1 ... Tuning model for up to 119.92s of the 590.2s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
E0101 04:14:40.069855345   12243 chttp2_transport.cc:1103]   Received a GOAWAY with error code ENHANCE_YOUR_CALM and debug data equal to &quot;too_many_pings&quot;
	Stopping HPO to satisfy time limit...
Fitted model: CatBoost_BAG_L1/T1 ...
	-34.4084	 = Validation score   (-root_mean_squared_error)
	105.1s	 = Training   runtime
	0.0s	 = Validation runtime
Hyperparameter tuning model: ExtraTrees_BAG_L1 ... Tuning model for up to 119.92s of the 485.06s of remaining time.
	No hyperparameter search space specified for ExtraTrees_BAG_L1. Skipping HPO. Will train one model based on the provided hyperparameters.
Fitted model: ExtraTrees_BAG_L1 ...
	-38.2952	 = Validation score   (-root_mean_squared_error)
	5.82s	 = Training   runtime
	0.0s	 = Validation runtime
Repeating k-fold bagging: 2/20
Fitting model: CatBoost_BAG_L1/T1 ... Training model for up to 279.2s of the 479.22s of remaining time.
	Warning: Exception caused CatBoost_BAG_L1/T1 to fail during training... Skipping this model.
		&#39;NoneType&#39; object has no attribute &#39;_user_params_aux&#39;
Detailed Traceback:
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/trainer/abstract_trainer.py&quot;, line 1422, in _train_and_save
    model = self._train_single(X, y, model, X_val, y_val, total_resources=total_resources, **model_fit_kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/trainer/abstract_trainer.py&quot;, line 1367, in _train_single
    model = model.fit(X=X, y=y, X_val=X_val, y_val=y_val, total_resources=total_resources, **model_fit_kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 688, in fit
    kwargs = self._preprocess_fit_args(**kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 428, in _preprocess_fit_args
    kwargs = self._preprocess_fit_resources(**kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 539, in _preprocess_fit_resources
    k_fold=k_fold
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 488, in _process_user_provided_resource_requirement_to_calculate_total_resource_when_ensemble
    user_specified_model_level_resource = self.model_base._user_params_aux.get(resource_type, None)
AttributeError: &#39;NoneType&#39; object has no attribute &#39;_user_params_aux&#39;
Repeating k-fold bagging: 3/20
Repeating k-fold bagging: 4/20
Repeating k-fold bagging: 5/20
Repeating k-fold bagging: 6/20
Repeating k-fold bagging: 7/20
Repeating k-fold bagging: 8/20
Repeating k-fold bagging: 9/20
Repeating k-fold bagging: 10/20
Repeating k-fold bagging: 11/20
Repeating k-fold bagging: 12/20
Repeating k-fold bagging: 13/20
Repeating k-fold bagging: 14/20
Repeating k-fold bagging: 15/20
Repeating k-fold bagging: 16/20
Repeating k-fold bagging: 17/20
Repeating k-fold bagging: 18/20
Repeating k-fold bagging: 19/20
Repeating k-fold bagging: 20/20
Completed 20/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 479.18s of remaining time.
	-37.1121	 = Validation score   (-root_mean_squared_error)
	0.18s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 3 L2 models ...
Hyperparameter tuning model: RandomForest_BAG_L2 ... Tuning model for up to 143.69s of the 478.97s of remaining time.
	No hyperparameter search space specified for RandomForest_BAG_L2. Skipping HPO. Will train one model based on the provided hyperparameters.
Fitted model: RandomForest_BAG_L2 ...
	-37.5434	 = Validation score   (-root_mean_squared_error)
	12.19s	 = Training   runtime
	0.0s	 = Validation runtime
Hyperparameter tuning model: CatBoost_BAG_L2 ... Tuning model for up to 143.69s of the 466.74s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Stopping HPO to satisfy time limit...
Fitted model: CatBoost_BAG_L2/T1 ...
	-35.4078	 = Validation score   (-root_mean_squared_error)
	98.44s	 = Training   runtime
	0.0s	 = Validation runtime
Hyperparameter tuning model: ExtraTrees_BAG_L2 ... Tuning model for up to 143.69s of the 368.25s of remaining time.
	No hyperparameter search space specified for ExtraTrees_BAG_L2. Skipping HPO. Will train one model based on the provided hyperparameters.
Fitted model: ExtraTrees_BAG_L2 ...
	-37.0729	 = Validation score   (-root_mean_squared_error)
	5.8s	 = Training   runtime
	0.0s	 = Validation runtime
Repeating k-fold bagging: 2/20
Fitting model: CatBoost_BAG_L2/T1 ... Training model for up to 362.43s of the 362.42s of remaining time.
	Warning: Exception caused CatBoost_BAG_L2/T1 to fail during training... Skipping this model.
		&#39;NoneType&#39; object has no attribute &#39;_user_params_aux&#39;
Detailed Traceback:
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/trainer/abstract_trainer.py&quot;, line 1422, in _train_and_save
    model = self._train_single(X, y, model, X_val, y_val, total_resources=total_resources, **model_fit_kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/trainer/abstract_trainer.py&quot;, line 1367, in _train_single
    model = model.fit(X=X, y=y, X_val=X_val, y_val=y_val, total_resources=total_resources, **model_fit_kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 688, in fit
    kwargs = self._preprocess_fit_args(**kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 428, in _preprocess_fit_args
    kwargs = self._preprocess_fit_resources(**kwargs)
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 539, in _preprocess_fit_resources
    k_fold=k_fold
  File &quot;/opt/conda/lib/python3.7/site-packages/autogluon/core/models/abstract/abstract_model.py&quot;, line 488, in _process_user_provided_resource_requirement_to_calculate_total_resource_when_ensemble
    user_specified_model_level_resource = self.model_base._user_params_aux.get(resource_type, None)
AttributeError: &#39;NoneType&#39; object has no attribute &#39;_user_params_aux&#39;
Repeating k-fold bagging: 3/20
Repeating k-fold bagging: 4/20
Repeating k-fold bagging: 5/20
Repeating k-fold bagging: 6/20
Repeating k-fold bagging: 7/20
Repeating k-fold bagging: 8/20
Repeating k-fold bagging: 9/20
Repeating k-fold bagging: 10/20
Repeating k-fold bagging: 11/20
Repeating k-fold bagging: 12/20
Repeating k-fold bagging: 13/20
Repeating k-fold bagging: 14/20
Repeating k-fold bagging: 15/20
Repeating k-fold bagging: 16/20
Repeating k-fold bagging: 17/20
Repeating k-fold bagging: 18/20
Repeating k-fold bagging: 19/20
Repeating k-fold bagging: 20/20
Completed 20/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the 362.38s of remaining time.
	-37.0359	 = Validation score   (-root_mean_squared_error)
	0.19s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 237.83s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230101_041430/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="45" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:18:42.454690Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:18:42.455121Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:18:42.498461Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:18:42.455161Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:18:42.497220Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                 model  score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0   CatBoost_BAG_L1/T1 -34.408449       0.000137  105.097142                0.000137         105.097142            1       True          2
1   CatBoost_BAG_L2/T1 -35.407838       0.000625  113.775652                0.000165          98.444743            2       True          6
2  WeightedEnsemble_L3 -37.035933       0.001752   33.504191                0.000829           0.186568            3       True          8
3    ExtraTrees_BAG_L2 -37.072898       0.000699   21.126664                0.000239           5.795755            2       True          7
4  WeightedEnsemble_L2 -37.112119       0.001376   15.513372                0.000916           0.182463            2       True          4
5  RandomForest_BAG_L2 -37.543357       0.000684   27.521868                0.000224          12.190959            2       True          5
6    ExtraTrees_BAG_L1 -38.295243       0.000214    5.816405                0.000214           5.816405            1       True          3
7  RandomForest_BAG_L1 -38.314947       0.000245    9.514504                0.000245           9.514504            1       True          1
Number of models trained: 8
Types of models trained:
{&#39;StackerEnsembleModel_CatBoost&#39;, &#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_RF&#39;, &#39;WeightedEnsembleModel&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;category&#39;, [])             : 2 | [&#39;season&#39;, &#39;weather&#39;]
(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])                  : 4 | [&#39;humidity&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;])            : 3 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;]
(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
*** End of fit() summary ***
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/autogluon/core/utils/plots.py:138: UserWarning: AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;
  warnings.warn(&#39;AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: &quot;pip install bokeh==2.0.1&quot;&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="45">
<pre><code>{&#39;model_types&#39;: {&#39;RandomForest_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1/T1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTrees_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;RandomForest_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L2/T1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTrees_BAG_L2&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;RandomForest_BAG_L1&#39;: -38.31494666065859,
  &#39;CatBoost_BAG_L1/T1&#39;: -34.40844862398389,
  &#39;ExtraTrees_BAG_L1&#39;: -38.29524277410234,
  &#39;WeightedEnsemble_L2&#39;: -37.11211858489802,
  &#39;RandomForest_BAG_L2&#39;: -37.54335678473709,
  &#39;CatBoost_BAG_L2/T1&#39;: -35.40783817117898,
  &#39;ExtraTrees_BAG_L2&#39;: -37.07289817891978,
  &#39;WeightedEnsemble_L3&#39;: -37.035932727470005},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;RandomForest_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_041430/models/RandomForest_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1/T1&#39;: &#39;/kaggle/working/AutogluonModels/ag-20230101_041430/models/CatBoost_BAG_L1/T1/&#39;,
  &#39;ExtraTrees_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_041430/models/ExtraTrees_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230101_041430/models/WeightedEnsemble_L2/&#39;,
  &#39;RandomForest_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_041430/models/RandomForest_BAG_L2/&#39;,
  &#39;CatBoost_BAG_L2/T1&#39;: &#39;/kaggle/working/AutogluonModels/ag-20230101_041430/models/CatBoost_BAG_L2/T1/&#39;,
  &#39;ExtraTrees_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_041430/models/ExtraTrees_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230101_041430/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;RandomForest_BAG_L1&#39;: 9.514504194259644,
  &#39;CatBoost_BAG_L1/T1&#39;: 105.09714198112488,
  &#39;ExtraTrees_BAG_L1&#39;: 5.816404581069946,
  &#39;WeightedEnsemble_L2&#39;: 0.1824631690979004,
  &#39;RandomForest_BAG_L2&#39;: 12.190958738327026,
  &#39;CatBoost_BAG_L2/T1&#39;: 98.44474291801453,
  &#39;ExtraTrees_BAG_L2&#39;: 5.79575514793396,
  &#39;WeightedEnsemble_L3&#39;: 0.1865684986114502},
 &#39;model_pred_times&#39;: {&#39;RandomForest_BAG_L1&#39;: 0.0002453327178955078,
  &#39;CatBoost_BAG_L1/T1&#39;: 0.00013709068298339844,
  &#39;ExtraTrees_BAG_L1&#39;: 0.0002143383026123047,
  &#39;WeightedEnsemble_L2&#39;: 0.0009162425994873047,
  &#39;RandomForest_BAG_L2&#39;: 0.00022411346435546875,
  &#39;CatBoost_BAG_L2/T1&#39;: 0.0001652240753173828,
  &#39;ExtraTrees_BAG_L2&#39;: 0.00023937225341796875,
  &#39;WeightedEnsemble_L3&#39;: 0.0008289813995361328},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;RandomForest_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1/T1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTrees_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForest_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L2/T1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTrees_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                  model  score_val  pred_time_val    fit_time  \
 0   CatBoost_BAG_L1/T1 -34.408449       0.000137  105.097142   
 1   CatBoost_BAG_L2/T1 -35.407838       0.000625  113.775652   
 2  WeightedEnsemble_L3 -37.035933       0.001752   33.504191   
 3    ExtraTrees_BAG_L2 -37.072898       0.000699   21.126664   
 4  WeightedEnsemble_L2 -37.112119       0.001376   15.513372   
 5  RandomForest_BAG_L2 -37.543357       0.000684   27.521868   
 6    ExtraTrees_BAG_L1 -38.295243       0.000214    5.816405   
 7  RandomForest_BAG_L1 -38.314947       0.000245    9.514504   
 
    pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                0.000137         105.097142            1       True   
 1                0.000165          98.444743            2       True   
 2                0.000829           0.186568            3       True   
 3                0.000239           5.795755            2       True   
 4                0.000916           0.182463            2       True   
 5                0.000224          12.190959            2       True   
 6                0.000214           5.816405            1       True   
 7                0.000245           9.514504            1       True   
 
    fit_order  
 0          2  
 1          6  
 2          8  
 3          7  
 4          4  
 5          5  
 6          3  
 7          1  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="46" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:18:57.022482Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:18:57.023762Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:18:58.934518Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:18:57.023822Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:18:58.932587Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo <span class="op">=</span> predictor_new_hpo.predict(test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="47" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:01.690401Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:01.690809Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:01.700315Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:01.690848Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:01.699068Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<pre><code>0        11.407879
1         6.071515
2         4.545253
3         2.827879
4         2.686566
           ...    
6488    327.231018
6489    238.884338
6490    174.068573
6491    113.614143
6492     93.080910
Name: count, Length: 6493, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:04.182417Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:04.183767Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:04.191715Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:04.183811Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:04.190765Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo[predictions_new_hpo<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="49" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:09.022881Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:09.023353Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:09.032801Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:09.023398Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:09.031371Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo[predictions_new_hpo<span class="op">&lt;</span><span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="49">
<pre><code>Series([], Name: count, dtype: float32)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="50" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:13.641039Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:13.641477Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:13.653482Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:13.641524Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:13.652465Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>submission_new_hpo <span class="op">=</span> pd.read_csv(<span class="st">&quot;sampleSubmission.csv&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="51" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:18.925090Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:18.925490Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:18.949968Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:18.925527Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:18.948668Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>submission_new_hpo[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_hpo</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>submission_new_hpo.to_csv(<span class="st">&quot;submission_new_hpo.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="52" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:21.390134Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:21.390539Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:24.129733Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:21.390579Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:24.128166Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_hpo.csv <span class="op">-</span>m <span class="st">&quot;new features with hyperparameters&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188k/188k [00:00&lt;00:00, 988kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="53" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:19:42.833332Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:19:42.833804Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:19:44.734015Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:19:42.833848Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:19:44.731911Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                                                                                                                                                                                           status    publicScore  privateScore  
---------------------------  -------------------  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------  --------  -----------  ------------  
submission_new_hpo.csv       2023-01-01 04:19:23  new features with hyperparameters                                                                                                                                                                     complete  0.47101      0.47101       
submission_new_features.csv  2023-01-01 04:11:55  new features                                                                                                                                                                                          complete  0.45275      0.45275       
submission.csv               2023-01-01 03:57:11  first raw submission                                                                                                                                                                                  complete  1.81002      1.81002       
submission_new_hpo.csv       2022-12-31 22:24:57  new features with hyperparameters                                                                                                                                                                     complete  0.47101      0.47101       
tail: write error: Broken pipe
</code></pre>
</div>
</div>
<section id="new-score-of-047101" class="cell markdown">
<h4>New Score of <code>0.47101</code></h4>
</section>
<section id="step-7-write-a-report" class="cell markdown">
<h2>Step 7: Write a Report</h2>
<h3 id="refer-to-the-markdown-file-for-the-full-report">Refer to the markdown file for the full report</h3>
<h3 id="creating-plots-and-table-for-report">Creating plots and table for report</h3>
</section>
<div class="cell code" data-execution_count="54" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:20:54.767060Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:20:54.767591Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:20:55.115154Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:20:54.767647Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:20:55.113756Z&quot;}" data-tags="[]" data-trusted="true">
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taking the top model score from each training run and creating a line plot to show improvement</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You can create these in the notebook and save them to PNG or use some other tool (e.g. google sheets, excel)</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.DataFrame(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>],</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: [<span class="op">-</span><span class="fl">50.788422</span>, <span class="op">-</span><span class="fl">31.779829</span>, <span class="op">-</span><span class="fl">34.408449</span>]</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>).plot(x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score&quot;</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)).get_figure()</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">&#39;model_train_score.png&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/dcda468294edc749f5f76fae491b2ccf8f02fce5.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="55" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:21:13.526536Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:21:13.526958Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:21:13.810165Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:21:13.526997Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:21:13.809269Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the 3 kaggle scores and creating a line plot to show improvement</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.DataFrame(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;test_eval&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>],</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: [<span class="fl">1.81002</span>, <span class="fl">0.45275</span>, <span class="fl">0.47101</span>]</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>).plot(x<span class="op">=</span><span class="st">&quot;test_eval&quot;</span>, y<span class="op">=</span><span class="st">&quot;score&quot;</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)).get_figure()</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">&#39;model_test_score.png&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_ec5fde65203d46a5a4c34123a738bd36/f2c2e5022e93d72a4c23320170ed6a7b2dd30b51.png" /></p>
</div>
</div>
<section id="hyperparameter-table" class="cell markdown">
<h3>Hyperparameter table</h3>
</section>
<div class="cell code" data-execution_count="56" data-execution="{&quot;iopub.status.busy&quot;:&quot;2023-01-01T04:21:22.325601Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-01-01T04:21:22.326020Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-01-01T04:21:22.345775Z&quot;,&quot;iopub.execute_input&quot;:&quot;2023-01-01T04:21:22.326057Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-01-01T04:21:22.344125Z&quot;}" data-trusted="true">
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The 3 hyperparameters we tuned with the kaggle score as the result</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;model&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>],</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo1&quot;</span>: [<span class="st">&quot;default&quot;</span>, <span class="st">&quot;default&quot;</span>, <span class="st">&quot;&#39;CAT&#39;: {&#39;iterations&#39;: 10000}&quot;</span>],</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo2&quot;</span>: [<span class="st">&quot;default&quot;</span>, <span class="st">&quot;default&quot;</span>, <span class="st">&quot;&#39;RF&#39;: {&#39;n_estimators&#39;: 300}&quot;</span>],</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo3&quot;</span>: [<span class="st">&quot;default&quot;</span>, <span class="st">&quot;default&quot;</span>, <span class="st">&quot;&#39;XT&#39;: {&#39;n_estimators&#39;: 300}&quot;</span>],</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;score&quot;</span>: [<span class="fl">1.81002</span>, <span class="fl">0.45275</span>, <span class="fl">0.47101</span>]</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>})                                                                                                                                                                                                                                                    </span></code></pre></div>
<div class="output execute_result" data-execution_count="56">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>hpo1</th>
      <th>hpo2</th>
      <th>hpo3</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>initial</td>
      <td>default</td>
      <td>default</td>
      <td>default</td>
      <td>1.81002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>add_features</td>
      <td>default</td>
      <td>default</td>
      <td>default</td>
      <td>0.45275</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hpo</td>
      <td>'CAT': {'iterations': 10000}</td>
      <td>'RF': {'n_estimators': 300}</td>
      <td>'XT': {'n_estimators': 300}</td>
      <td>0.47101</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</body>
</html>
